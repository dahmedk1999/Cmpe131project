<!DOCTYPE html>
<html>

<head>
  
  <style>
    /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
    #map {
      height: 100%;
    }

    #right-panel{
    font-family: "Roboto", "sans-serif";
    line-height: 30px;
    padding-left: 10px;
    }
    /* Optional: Makes the sample page fill the window. */
    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    
  </style>
</head>

<body>


  <script>




    var myLatlng = new google.maps.LatLng(37.337341228, -121.8766039);
    var StartingMarker;
    var DestinationMarker;
    var directionsbetweenmarkers;
    var swap = 0;

    var OriginCoord;
    var DestCoord;

    /**
     * Creates a map object with a click listener and a marker.
     */
    function initMap() {
      var directionsService = new google.maps.DirectionsService();
      var directionsRenderer = new google.maps.DirectionsRenderer();

      var map = new google.maps.Map(document.getElementById('map'), {
        center: { lat: 37.337341228, lng: -121.8766039 },
        zoom: 15,
        styles: [{
          featureType: 'poi',
          stylers: [{ visibility: 'on' }]  // Turn on POI.
        },
        {
          featureType: 'transit.station',
          stylers: [{ visibility: 'on' }]  // Turn on bus, train stations etc.
        }],
        disableDoubleClickZoom: true,
        streetViewControl: true,
      });
      //does not work
      directionsRenderer.setMap(map);
      ////////////////
      


      // Listen for clicks and add the location of the click to firebase.
      map.addListener('dblclick', function (event) {
        placeMarkers(event.latLng, map);

      });


      // Create starting and destination markers on double click.
      //If both markers are set, just move the previous marker
      function placeMarkers(location) {
        if (StartingMarker == null) {
          StartingMarker = new google.maps.Marker({
            position: location,
            map: map,
            draggable: true,
          });
          OriginCoord=StartingMarker.position;
        }
        else if (DestinationMarker == null) {
          DestinationMarker = new google.maps.Marker({
            position: location,
            map: map,
            draggable: true,
          });
          DestCoord=DestinationMarker.position;
        }
        else {
          if (!swap) {
            StartingMarker.setPosition(location); swap = 1;OriginCoord=StartingMarker.position;
          }
          else if (swap) {
            DestinationMarker.setPosition(location); swap = 0;DestCoord=DestinationMarker.position;
          }
        }
      }

      //below does not work
      directionsDisplay.setMap(map);
      directionsDisplay.setPanel(document.getElementById('panel'));
      
      var request = {
           origin: StartingMarker.position, 
           destination: DestinationMarker.position,
           travelMode: google.maps.DirectionsTravelMode.DRIVING
         };
      directionsService.route(request, function (response, status) {
        if (status == google.maps.DirectionsStatus.OK) {
          directionsDisplay.setDirections(response);
        }
        else alert("Directions Request invalid, Error: " + status);
      });
      ////////////////////
    }

  </script>
  <script defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD_eiQ1CH1VTFNnQLGLxigPL-F76Gplu0U&libraries=visualization&callback=initMap">
    </script>
      <div id="map" style="width: 70%;float:left;"></div>
      <div id="right-panel"></div>
</body>

</html>
